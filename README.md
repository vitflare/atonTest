# Тестовое задание на программу стажировки ITTP 2024

## Перед началом работы
Необходимо поднять базу данных PostgreSQL и создать миграции с помощью команды:
```
docker-compose up
```

## Авторизация и аутентификация
Для авторизации и аутентификации используется JWT токен. Для получения токена необходимо отправить POST запрос на `/Tokens/login` с телом:
```json
{
  "login": "string",
  "password": "string"
}
```
В ответ ручка вернет два токена: Access и Refresh. 
Access-токен необходим для доступа к ресурсам, а Refresh - для обновления Access-токена.

Для использования токенов необходимо нажать кнопку `Authorize` в Swagger UI и ввести токен в поле `Value` в формате `Bearer *token_value*`.

## Особенности
- Свойства `RevokedOn` и `RevokedBy` могут принимать значения null, так как в описании некоторых ручек написано о возможно отсутствии этих полей.
- После использования ручки `/Users/update-login` необходимо пересоздавать Access-токен (если запрос происходит от лица пользователя, который авторизован под изменяющимся в ручке логином), так как в теле токена хранится логин пользователя и получится, что его логин не совпадает с логином в базе данных.
<br> Это приведет к тому, что при попытке сделать что-то под этим токеном (например, снова поменять логин), сервер вернет ошибку 401.
<br>Эту проблему можно было бы решить с помощью использования Redis (но это сильно выходит за рамки тестового задания, поэтому я оставила это в виде ремарки). 
<br>Идея заключается в том, что при создании токена, он бы сохранялся в Redis в формате `login:token` c временем жизни, равным времени жизни токена. И при срабатывании ручки изменения логина, сервер бы также удалял из Redis все токены, связанные с этим пользователем.